# Прогнозирование показателей доходности и риска банков с помощью текущих результатов деятельности и анализа новостей
#### *Prediction of banks’ performance and risks using current business results and news sentiment analysis*

----

| Роль | ФИО |
| ----------- | ----------- |
| **Автор работы** | Козачкин Тимофей Дмитриевич |
| **Руководитель** | Бабынин Андрей Игоревич |

### Описание
***Цель**: создать модель, комбинирующую данные о результатах деятельности банков и новостной фон вокруг них, которая будет способна предсказывать показатели доходности и риска кредитных организаций важных для принятия инвестиционных решений*

Помимо фундаментальных причин, оказывающих влияние на деятельность банковской организации и ее результаты, таких как руководство или совет директоров, финансирование, политика в отношении клиентов и пр., имеющих внутреннее происхождение, т.е. появившихся в результате решений принятых в банке, внешние причины также могут заметно повлиять на бизнес кредитной организации. Новости о политике, регулировании, обществе, культуре могут сыграть важную роль в деятельности банка. Иногда эта роль может быть не очевидна, но чаще эта роль никак не может быть количественно измерена. 

Анализ сентимента и структуры новостей проводится с помощью нейросетевых подходов, демонстрирующих хорошее качество в этой задаче. Похожие модели могут найти применение в финансовой сфере.

В работе хочется построить модель, которая скомбинирует преимущества нейросетевых моделей для текстов новостей и данные о деятельности банков, чтобы на основании этих двух источников данных (внешних и внутренних) построить единую модель, способную предсказывать количественно влияние того или иного новостного события. Для измерения этого влияния планируется использовать показатели доходности и риска банка - вероятность дефолта (отзыва лицензии) ROE, ROA, EPS, NI и др.

### План выполнения ВКР

| Пункт | Срок | Результат | Директория        |
| ----------- | ----------- | ----------- |-------------------|
| Сбор и агрегация данных + EDA | до 24.03 | Датасеты с данными по банкам и новостями | `/data`           |
| Построение простой ML-модели на данных банков | до 01.04 | Первая модель на табличных данных | `/model/ML`       |
| Построение/Fine-tuning модели на новостных данных | до 21.04 | Модель на данных новостей | `/model/DL`       |
| Эксперименты с моделями, данными и их комбинациями* | до 01.05 | Сравнение различных конфигураций моделей | `/model/combined` |
| Разработка сервиса | май | Готовый сервис, предсказывающий влияние новости на показатели | `/app`            |

'*' *эксперименты подразумевают попытки повышения качества модели через различные конфигурациями модели. Для примера конфигурации, которые будут сравниваться:* 
* предсказания 2 отдельных моделей проходят через регрессию
* в модель предсказания на основе новостей добавляются результаты из простой модели в качестве признаков
* варианты различных языковых моделей в двух конфигурациях выше 

### Описание данных

| Название датасета | Количество наблюдений / Объем данных |
| ----------- | ----------- |
| [Датасет с показателями деятельности (в т.ч. дефолтов) российских банков](https://www.kaggle.com/datasets/johnds2/bankdefaultsinrussia/data) | 70k |
| [Russian Telegram chats history](https://www.kaggle.com/datasets/dolfik/russian-telegram-chats-history/data) | 177 историй новостных чатов (3GB) |
|[News dataset from Lenta.Ru](https://www.kaggle.com/datasets/yutkin/corpus-of-russian-news-articles-from-lenta) | 800k |
| [Russian News 2020](https://www.kaggle.com/datasets/vfomenko/russian-news-2020)| 21k |
| *to be added/updated* | - |

*вероятно будут добавлены парсеры некоторых источников финансовых данных либо другие более подходящие датасеты после анализа представленных датасетов.*

### Описание итогового продукта

Итоговый сервис будет предсказывать показателей доходности и рисков банка:
* на основании имеющихся данных 
* на основании новых новостей, т.е. показывать как изменяются предсказания от появления той или иной новости

Стэк:
* Язык разработки: Python 3.10.4
* Менеджмент зависимостей: pip, conda
* Менеджмент версий python: poetry
* Система контроля версий данных, менеджмент workflow: dvc, google drive
* Шаблонизатор: coockiecutter
* Линтер: flake8
* Автоформаттер: black
* Мониторинг: MLflow
* ML-стэк: catboost, sklearn, pandas, numpy, pytorch
* Тестирование: pytest
